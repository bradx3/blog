<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>7</title>
   <meta name="author" content="" />

   <!--- Blueprint CSS Framework -->
   <link rel="stylesheet" href="/css/blueprint/screen.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/blueprint/print.css" type="text/css" media="print" />

   <!-- CodeRay syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/coderay.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/site.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/style.css" type="text/css" />

   <!-- SyntaxHighlighter -->
   <script type="text/javascript" src="/scripts/shCore.js"></script>
   <script type="text/javascript" src="/scripts/shBrushBash.js"></script>
   <script type="text/javascript" src="/scripts/shBrushJScript.js"></script>
   <script type="text/javascript" src="/scripts/shBrushPlain.js"></script>
   <script type="text/javascript" src="/scripts/shBrushRuby.js"></script>
   <script type="text/javascript" src="/scripts/shBrushSql.js"></script>
   <script type="text/javascript" src="/scripts/shBrushXml.js"></script>
   <link type="text/css" rel="stylesheet" href="/styles/shCore.css"/>
   <link type="text/css" rel="stylesheet" href="/styles/shThemeDefault.css"/>
   <script type="text/javascript">
     SyntaxHighlighter.config.clipboardSwf = 'scripts/clipboard.swf';
     SyntaxHighlighter.all();
   </script>
</head>
<body>

<div class="container">

   <div class="column span-20 prepend-2 append-2 first last" id="header">
     <a href="/">
       <img src="/images/banner.gif" alt="Lucky-Dip Blog"/>
     </a>
   </div>

   <div class="column span-15 prepend-2 first content">
      <h2>7</h2>

<div class="article">
  <h1><a href="/articles/2009/07/24/my-backup-script/">My Backup Script</a><span class="date">(2009-07-24)</span></h1>

  <div class="body">
    <p>
  This is my simple backup script. It keeps everything I don't already have backed up 
  in version control safe and sound from hardware failure. Not from me though - 
  if I delete a file accidentally, that file is really gone
  (unless you act fast before the next backup runs!). 
  If I make a bad edit, that file is busted.
  <br />
  <br />
  But I can live with that. 
</p>

<p>
  <h3>backup.rb</h3>
  Backup.rb uses rsync over ssh to backup a number of different server. Rsync is good
  because it only sends what changed, so we're not transferring gigs every night.
  <br /><br />
  You'll have to make some changes to the SSH_USER, REMOTE_DIR and HOSTS constants. 
  You could also add any file types you want to ignore to the EXCLUDES list.

  <pre class="brush: ruby">
#!/usr/bin/env ruby

NAME = %x{ hostname }.strip
SSH_USER = "brad"
REMOTE_DIR = "/home/brad/Backups/#{ NAME }"

HOSTS = [ "clamps", "hubert.lucky-dip.net" ]
DIRS = [
        "~/Library", 
        "~/Documents",
        "~/Pictures"
]
EXCLUDES = [
            "*Cache*",
            "*NewsFire*",
            "*Cookies*",
            "*.log",
            "HistoryIndex.ox*",
            "*Virtual Machines*",
            "*.resume",
            "*.ipsw",
            "*.dmg",
            "*.corrupt"
]

HOSTS.each do |host|
  DIRS.each do |dir|
    puts "--------------------------------------------"
    excludes = EXCLUDES.map { |e| "--exclude \"#{ e }\"" }.join(' ')
    cmd = "rsync -av --delete --delete-excluded "
    cmd += " --rsh=\"ssh -l #{ SSH_USER }\" "
    cmd += " #{ dir } #{ host }:#{ REMOTE_DIR } #{ excludes }"
    puts cmd
    system(cmd)
  end
end
  </pre>
</p>
<p>
  <h3>Crontab</h3>
  With the crontab below, a backup will be run every night at 10pm
  <pre class="brush: bash">
    0 22 * * * /Users/brad/projects/scripts/backup.rb
  </pre>
</p>

  </div>
</div>
<div class="article">
  <h1><a href="/articles/2009/07/10/creating-a-jruby-rails-project/">Creating a jruby rails project</a><span class="date">(2009-07-10)</span></h1>

  <div class="body">
    <p>
For some reason, this command:
<pre class="brush: bash">
jruby -S gem install mongrel activerecord-jdbcmysql-adapter rails
</pre>
didn't install all the required gems I needed.
</p>
<p>
Manually listing all the basic rails gems needed fixed the problem for me though. Working command:
<pre class="brush: bash">
jruby -S gem install mongrel activerecord-jdbcmysql-adapter rails \
activesupport actionmailer activerecord actionpack activeresource
</pre>

  </div>
</div>

   </div>

   <div class="column span-5 append-2 last sidebar">
     <h4>About</h4>
     <div>
       <img src="/images/brad_head.gif" />
       <p>My name is Brad. I am a programmer from Sydney, Australia. I like lots of coding stuff, but especially ruby and iPhone.
       </p>
       <p>I am available for contracting work. Contact me at brad at lucky-dip.net</p>
     </div>

     <h4>What I'm...</h4>
     <div>
       <ul>
       <li><a href="http://github.com/bradx3">Working on</a></li>
       <li><a href="http://twitter.com/bradx3">Thinking</a></li>
       </ul>
     </div>

     <h4>Syndicate</h4>
     <div>
       <a href="/feed.xml">RSS</a>
     </div>

   </div>

   <div class="column span-20 prepend-2 append-2 first last" id="footer">
     <hr />
     <p>This website was created with <a href="http://webby.rubyforge.org">Webby</a></p>
   </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-19254782-1']);
  _gaq.push(['_setDomainName', '.lucky-dip.net']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
